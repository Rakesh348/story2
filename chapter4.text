this is chapter4 from experimental branch and forked into new repository
